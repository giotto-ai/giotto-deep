<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data &mdash; giotto-deep 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="Analysis" href="analysis.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> giotto-deep
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distributed.html">Distributed computing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-gdeep.data.preprocessors">Preprocessors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gdeep.data.datasets">Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-gdeep.data.persistence_diagrams">Persistence Diagrams</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="trainer.html">Trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="search.html">Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="topology_layers.html">Topology Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="utility.html">Utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualisation.html">Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#references">References</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">giotto-deep</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">API reference</a> &raquo;</li>
      <li>Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-gdeep.data">
<span id="data"></span><h1>Data<a class="headerlink" href="#module-gdeep.data" title="Permalink to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.AbstractPreprocessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">AbstractPreprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.AbstractPreprocessing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.DatasetFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">DatasetFactory</span></span><a class="headerlink" href="#gdeep.data.DatasetFactory" title="Permalink to this definition"></a></dt>
<dd><p>Dataset factory class for the tori dataset and torchvision datasets
using the factory design pattern</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a dataset for the tori dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="s2">&quot;Tori&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;DoubleTori&quot;</span><span class="p">,</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Create the MNIST dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span><span class="s2">&quot;Torchvision&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MNIST&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DatasetFactory.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#gdeep.data.DatasetFactory.build" title="Permalink to this definition"></a></dt>
<dd><p>This method returns the DataLoader builder
corresponding to the input key.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>key:</dt><dd><p>the name of the dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.DatasetFactory.register_builder">
<span class="sig-name descname"><span class="pre">register_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">builder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.DatasetFactory.register_builder" title="Permalink to this definition"></a></dt>
<dd><p>this method adds to the internal builders dictionary
new dataloader builders</p>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="gdeep.data.MissingVocabularyError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">MissingVocabularyError</span></span><a class="headerlink" href="#gdeep.data.MissingVocabularyError" title="Permalink to this definition"></a></dt>
<dd><p>Class to raise the missing vocabulary
esception in the toknizers</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.PreprocessingPipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">PreprocessingPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preprocessors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.AbstractPreprocessing" title="gdeep.data.abstract_preprocessing.AbstractPreprocessing"><span class="pre">AbstractPreprocessing</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.PreprocessingPipeline" title="Permalink to this definition"></a></dt>
<dd><p>Pipeline to fit non-fitted preprocessors to a dataset in a sequential manner.
The fitted preprocessing transform can be attached to a dataset using
the ´attach_transform_to_dataset´ method.
The intended use case is to fit the preprocessors to the training dataset and
then attach the fitted transform to the training, validation and test datasets.</p>
<p>The transform is only applied to the data and not the labels.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data.preeprocessors</span> <span class="kn">import</span> <span class="n">PreprocessingPipeline</span><span class="p">,</span> <span class="n">Normalization</span><span class="p">,</span>             <span class="n">PreprocessImageClassification</span>
<span class="kn">from</span> <span class="nn">gdeep.data.datasets</span> <span class="kn">import</span> <span class="n">DatasetImageClassificationFromFiles</span>

<span class="n">image_dataset</span> <span class="o">=</span> <span class="n">DatasetImageClassificationFromFiles</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;img_data&quot;</span><span class="p">),</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;img_data&quot;</span><span class="p">,</span> <span class="s2">&quot;labels.csv&quot;</span><span class="p">))</span>

<span class="n">preprocessing_pipeline</span> <span class="o">=</span> <span class="n">PreprocessingPipeline</span><span class="p">((</span><span class="n">PreprocessImageClassification</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)),</span>
                                                <span class="n">Normalization</span><span class="p">()))</span>
<span class="n">preprocessing_pipeline</span><span class="o">.</span><span class="n">fit_to_dataset</span><span class="p">(</span><span class="n">image_dataset</span><span class="p">)</span>  <span class="c1"># this will not change the image_dataset</span>
<span class="n">preprocessed_dataset</span> <span class="o">=</span> <span class="n">preprocessing_pipeline</span><span class="o">.</span><span class="n">attach_transform_to_dataset</span><span class="p">(</span><span class="n">image_dataset</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.TransformingDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.</span></span><span class="sig-name descname"><span class="pre">TransformingDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">R</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">R</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">S</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.TransformingDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class is the base class for the all
Datasets that need to be transformed via preprocessors.
This base class expects to get data from Dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset :</dt><dd><p>The source dataset for this class.</p>
</dd>
<dt>transform :</dt><dd><p>This is either a function defined by the
users or a fitted preprocessor. The
preprocessors inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<section id="module-gdeep.data.preprocessors">
<span id="preprocessors"></span><h2>Preprocessors<a class="headerlink" href="#module-gdeep.data.preprocessors" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.FilterPersistenceDiagramByHomologyDimension">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">FilterPersistenceDiagramByHomologyDimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">homology_dimensions_to_filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.FilterPersistenceDiagramByHomologyDimension" title="Permalink to this definition"></a></dt>
<dd><p>This class filters the persistence diagrams of a dataset by their homology dimension.</p>
<p>Here we assume that the dataset is a tuple of (persistence diagram, label) and that
the points in the diagram are sorted by ascending lifetime. This is an invariant of
the OneHotEncodedPersistenceDiagram class but could go wrong if the diagrams are modified
in a way that breaks this invariant.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>homology_dimensions_to_filter:</dt><dd><p>The homology dimensions of the points in the diagram that should be kept.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.FilterPersistenceDiagramByHomologyDimension.fit_to_dataset">
<span class="sig-name descname"><span class="pre">fit_to_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.preprocessors.FilterPersistenceDiagramByHomologyDimension.fit_to_dataset" title="Permalink to this definition"></a></dt>
<dd><p>This method does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.FilterPersistenceDiagramByLifetime">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">FilterPersistenceDiagramByLifetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_lifetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lifetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.FilterPersistenceDiagramByLifetime" title="Permalink to this definition"></a></dt>
<dd><p>This class filters the persistence diagrams of a dataset by their lifetime, i.e.
the difference between the birth and death coordinates.</p>
<p>Here we assume that the dataset is a tuple of (persistence diagram, label) and that
the points in the diagram are sorted by ascending lifetime. This is an invariant of
the OneHotEncodedPersistenceDiagram class but could go wrong if the diagrams are modified
in a way that breaks this invariant.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>min_lifetime:</dt><dd><p>The minimum lifetime of the points in the diagram.</p>
</dd>
<dt>max_lifetime:</dt><dd><p>The maximum lifetime of the points in the diagram.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.FilterPersistenceDiagramByLifetime.fit_to_dataset">
<span class="sig-name descname"><span class="pre">fit_to_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.preprocessors.FilterPersistenceDiagramByLifetime.fit_to_dataset" title="Permalink to this definition"></a></dt>
<dd><p>This method does nothing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.MinMaxScalarPersistenceDiagram">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">MinMaxScalarPersistenceDiagram</span></span><a class="headerlink" href="#gdeep.data.preprocessors.MinMaxScalarPersistenceDiagram" title="Permalink to this definition"></a></dt>
<dd><p>This class runs the standard min-max normalisation on the birth and death times 
of the persistence diagrams. For example. The transformation is:
X_scaled = X_std * (max - min) + min</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.Normalization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">Normalization</span></span><a class="headerlink" href="#gdeep.data.preprocessors.Normalization" title="Permalink to this definition"></a></dt>
<dd><p>This class runs the standard normalisation on all the dimensions of
the tensors of a dataset. For example, in case of images where each item is of
shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code>, the average will and the standard deviations
will be tensors of shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">H,</span> <span class="pre">W)</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.NormalizationPersistenceDiagram">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">NormalizationPersistenceDiagram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_homology_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.NormalizationPersistenceDiagram" title="Permalink to this definition"></a></dt>
<dd><p>This class runs the standard normalisation on the birth and death coordinates
of the persistence diagrams of a dataset accross all the homology dimensions.</p>
<p>The one-hot encoded persistence diagrams are kept as is.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.ToTensorImage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">ToTensorImage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.ToTensorImage" title="Permalink to this definition"></a></dt>
<dd><p>Class to preprocess image files for classification
tasks</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>size :</dt><dd><p>Desired output size. If size is a sequence like (h, w),
output size will be matched to this. If size is an int,
smaller edge of the image will be matched to this number.
I.e, if height &gt; width, then image will be rescaled to
<code class="docutils literal notranslate"><span class="pre">(size</span> <span class="pre">*</span> <span class="pre">height</span> <span class="pre">/</span> <span class="pre">width,</span> <span class="pre">size)</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.TokenizerQA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">TokenizerQA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Vocab</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">partial</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.TokenizerQA" title="Permalink to this definition"></a></dt>
<dd><p>Class to preprocess text dataloaders for Q&amp;A
tasks. The type of dataset is assumed to be of the
form <code class="docutils literal notranslate"><span class="pre">(string,string,list[string],</span> <span class="pre">list[string])</span></code>.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>vocabulary:</dt><dd><p>the torch vocabulary</p>
</dd>
<dt>tokenizer :</dt><dd><p>the tokenizer of the source text</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TorchDataLoader</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TransformingDataset</span>
<span class="kn">from</span> <span class="nn">gdeep.data.preprocessors</span> <span class="kn">import</span> <span class="n">TokenizerQA</span>

<span class="n">dl</span> <span class="o">=</span> <span class="n">TorchDataLoader</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;SQuAD2&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dl_tr</span><span class="p">,</span> <span class="n">dl_ts</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="n">build_dataloaders</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TransformingDataset</span><span class="p">(</span><span class="n">dl_tr_str</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span>
                       <span class="n">TokenizerQA</span><span class="p">())</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.TokenizerQA.fit_to_dataset">
<span class="sig-name descname"><span class="pre">fit_to_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.preprocessors.TokenizerQA.fit_to_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Method to fit the vocabulary to the input text</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset:</dt><dd><p>the dataset to fit to</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.TokenizerTextClassification">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">TokenizerTextClassification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">partial</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Vocab</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.TokenizerTextClassification" title="Permalink to this definition"></a></dt>
<dd><p>Preprocessing class. This class is useful to convert the data format
<code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">text)</span></code> into the proper tensor format <code class="docutils literal notranslate"><span class="pre">(</span> <span class="pre">word_embedding,</span> <span class="pre">label)</span></code>.
The labels shouzld be interagers; f they ar string, they will be converted.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>tokenizer :</dt><dd><p>the tokenizer of the source text</p>
</dd>
<dt>vocabulary :</dt><dd><p>the vocubulary; it can be built of it can be
given.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.TokenizerTextClassification.fit_to_dataset">
<span class="sig-name descname"><span class="pre">fit_to_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.preprocessors.TokenizerTextClassification.fit_to_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Method to extract global data, like to length of
the sentences to be able to pad.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset :</dt><dd><p>the data in the format <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">text)</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.preprocessors.TokenizerTranslation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.preprocessors.</span></span><span class="sig-name descname"><span class="pre">TokenizerTranslation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocabulary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vocabulary_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.preprocessors.TokenizerTranslation" title="Permalink to this definition"></a></dt>
<dd><p>Class to preprocess text dataloaders for translation
tasks. The Dataset type is supposed to be <code class="docutils literal notranslate"><span class="pre">(string,</span> <span class="pre">string)</span></code>.
The padding item is supposed to be of index 0.</p>
<blockquote>
<div><dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>vocabulary :</dt><dd><p>the vocabulary of the source text;
it can be built automatically or it can be
given.</p>
</dd>
<dt>vocabulary_target :</dt><dd><p>the vocubulary of the target text;
it can be built automatically or it can be
given.</p>
</dd>
<dt>tokenizer:</dt><dd><p>the tokenizer of the source text</p>
</dd>
<dt>tokenizer_target:</dt><dd><p>the tokenizer of the target text</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">DatasetBuilder</span>
<span class="kn">from</span> <span class="nn">gdeep.data</span> <span class="kn">import</span> <span class="n">TransformingDataset</span>
<span class="kn">from</span> <span class="nn">gdeep.data.preprocessors</span> <span class="kn">import</span> <span class="n">TokenizerTranslation</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">DatasetBuilder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Multi30k&quot;</span><span class="p">,</span> <span class="n">convert_to_map_dataset</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds_tr</span><span class="p">,</span> <span class="n">ds_val</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

<span class="n">textds</span> <span class="o">=</span> <span class="n">TransformingDataset</span><span class="p">(</span><span class="n">ds_tr</span><span class="p">,</span>
    <span class="n">TokenizerTranslation</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-gdeep.data.datasets">
<span id="datasets"></span><h2>Datasets<a class="headerlink" href="#module-gdeep.data.datasets" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.AbstractDataLoaderBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">AbstractDataLoaderBuilder</span></span><a class="headerlink" href="#gdeep.data.datasets.AbstractDataLoaderBuilder" title="Permalink to this definition"></a></dt>
<dd><p>The abstractr class to interface the
Giotto dataloaders</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.DataLoaderBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">DataLoaderBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tuple_of_datasets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.DataLoaderBuilder" title="Permalink to this definition"></a></dt>
<dd><p>This class builds, out of a tuple of datasets, the
corresponding dataloaders. Note that this class would
use the same parameters for all the datasets</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>tuple_of_datasets :</dt><dd><p>the tuple eith the traing, validation and test
datasets. Also one or two elemennts are acceptable:
they will be considered as training first and
validation afterwards.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.DataLoaderBuilder.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tuple_of_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoaderParamsTuples</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.DataLoaderBuilder.build" title="Permalink to this definition"></a></dt>
<dd><p>This method accepts the arguments of the torch
Dataloader and applies them when creating the
tuple</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>tuple_of_kwargs:</dt><dd><p>List of dictionaries, each one being the
kwargs for the corresponding DataLoader</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.DataLoaderKwargs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">DataLoaderKwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_kwargs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.DataLoaderKwargs" title="Permalink to this definition"></a></dt>
<dd><p>Object to store keyword arguments for train, val, and test dataloaders</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.DatasetBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">DatasetBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MNIST'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to_map_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.DatasetBuilder" title="Permalink to this definition"></a></dt>
<dd><p>Class to obtain Datasets from the classical
datasets available on pytorch. Also the torus dataset
and all its variations can be found here</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>name:</dt><dd><p>check the available datasets at
<a class="reference external" href="https://pytorch.org/vision/stable/datasets.html">https://pytorch.org/vision/stable/datasets.html</a>
and <a class="reference external" href="https://pytorch.org/text/stable/datasets.html">https://pytorch.org/text/stable/datasets.html</a></p>
</dd>
<dt>convert_to_map_dataset:</dt><dd><p>whether to conver to the MapDataset or to keep
IterableDataset</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.DatasetBuilder.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.DatasetBuilder.build" title="Permalink to this definition"></a></dt>
<dd><p>Method that returns the dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>kwargs:</dt><dd><p>the arguments to pass to the dataset builder.
For example, you may want to use the options
<code class="docutils literal notranslate"><span class="pre">split=(&quot;train&quot;,&quot;dev&quot;)</span></code> or <code class="docutils literal notranslate"><span class="pre">split=(&quot;train&quot;,&quot;test&quot;)</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.DatasetCloud">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">DatasetCloud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bucket_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'adversarial_attack'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_public_access</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_credentials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">make_public</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.DatasetCloud" title="Permalink to this definition"></a></dt>
<dd><p>DatasetCloud class to handle the download and upload
of datasets to the DataCloud.
If the download_directory does not exist, it will be created and
if a folder with the same name as the dataset exists in the
download directory, it will not be downloaded again.
If a folder with the same name as the dataset does not exists
locally, it will be created when downloading the dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset_name (str):</dt><dd><p>Name of the dataset to be downloaded or uploaded.</p>
</dd>
<dt>bucket_name (str, optional):</dt><dd><p>Name of the bucket in the DataCloud.
Defaults to DATASET_BUCKET_NAME.</p>
</dd>
<dt>download_directory (Union[None, str], optional):</dt><dd><p>Directory where the
dataset will be downloaded to. Defaults to DEFAULT_DOWNLOAD_DIR.</p>
</dd>
<dt>use_public_access (bool, optional):</dt><dd><p>If True, the dataset will
downloaded via public url. Defaults to False.</p>
</dd>
<dt>path_credentials (Union[None, str], optional):</dt><dd><p>Path to the credentials file.
Only used if public_access is False and credentials are not
provided. Defaults to None.</p>
</dd>
<dt>make_public (bool, optional):</dt><dd><p>If True, the dataset will be made public</p>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>Dataset does not exits in cloud.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.DatasetCloud.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.datasets.DatasetCloud.download" title="Permalink to this definition"></a></dt>
<dd><p>Download a dataset from the DataCloud. If the dataset does not
exist in the cloud, an exception will be raised. If the dataset
exists locally in the download directory, the dataset will not be
downloaded again.</p>
<dl class="simple">
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>Dataset does not exits in cloud.</p>
</dd>
<dt>ValueError:</dt><dd><p>Dataset exists locally but checksums do not match.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.DatasetCloud.get_existing_datasets">
<span class="sig-name descname"><span class="pre">get_existing_datasets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.DatasetCloud.get_existing_datasets" title="Permalink to this definition"></a></dt>
<dd><p>Returns a list of datasets in the cloud.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>List[str]:</dt><dd><p>List of datasets in the cloud.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.DlBuilderFromDataCloud">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">DlBuilderFromDataCloud</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download_directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_public_access</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path_to_credentials</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.DlBuilderFromDataCloud" title="Permalink to this definition"></a></dt>
<dd><p>Class that loads data from Google Cloud Storage</p>
<p>This class is useful to build dataloaders from a dataset stored in
the GDeep Dataset Cloud on Google Cloud Storage.</p>
<p>The constructor takes the name of a dataset as a string, and a string
for the download directory. The constructor will download the dataset
to the download directory. The dataset is downloaded in the version
used by Datasets Cloud, which may be different from the version
used by the dataset’s original developers.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>dataset_name (str):</dt><dd><p>The name of the dataset.</p>
</dd>
<dt>download_dir (str):</dt><dd><p>The directory where the dataset will be downloaded.</p>
</dd>
<dt>use_public_access (bool):</dt><dd><p>Whether to use public access. If you want
to use the Google Cloud Storage API, you must set this to True.
Please make sure you have the appropriate credentials.</p>
</dd>
<dt>path_to_credentials (str):</dt><dd><p>Path to the credentials file.
Only used if public_access is False and credentials are not
provided. Defaults to None.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>torch.utils.data.DataLoader: The dataloader for the dataset.</p>
</dd>
<dt>Raises:</dt><dd><dl class="simple">
<dt>ValueError:</dt><dd><p>If the dataset_name is not a valid dataset that exists
in Datasets Cloud.</p>
</dd>
<dt>ValueError:</dt><dd><p>If the download_directory is not a valid directory.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.DlBuilderFromDataCloud.build">
<span class="sig-name descname"><span class="pre">build</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tuple_of_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.DlBuilderFromDataCloud.build" title="Permalink to this definition"></a></dt>
<dd><p>Builds the dataloaders for the dataset.</p>
<dl class="simple">
<dt>Args:</dt><dd><p><a href="#id1"><span class="problematic" id="id2">**</span></a>tuple_of_kwargs: Arguments for the dataloader builder.</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>Tuple[DataLoader, DataLoader, DataLoader]:</dt><dd><p>The dataloaders for the dataset (train, validation, test).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.DlBuilderFromDataCloud.get_metadata">
<span class="sig-name descname"><span class="pre">get_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.DlBuilderFromDataCloud.get_metadata" title="Permalink to this definition"></a></dt>
<dd><p>Returns the metadata of the dataset.</p>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>Dict[str, Any]:</dt><dd><p>The metadata of the dataset.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.FromArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">FromArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.FromArray" title="Permalink to this definition"></a></dt>
<dd><p>This class is useful to build dataloaders
from a array of X and y. Tensors are also supported.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>X :</dt><dd><p>The data. The first dimension is the datum index</p>
</dd>
<dt>y :</dt><dd><p>The labels, need to match the first dimension
with the data</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.ImageClassificationFromFiles">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">ImageClassificationFromFiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'labels.csv'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.ImageClassificationFromFiles" title="Permalink to this definition"></a></dt>
<dd><p>This class is useful to build a dataset
directly from image files</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>img_folder (string):</dt><dd><p>The path to the folder where the training
images are located</p>
</dd>
<dt>labels_file (string):</dt><dd><p>The path and file name of the labels.
It shall be a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file with two columns.
The first columns contains the name of the
image and the second one contains the
label value</p>
</dd>
<dt>transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
<dt>target_transform (AbstractPreprocessing):</dt><dd><p>the instance of the class of preprocessing.
It inherits from <code class="docutils literal notranslate"><span class="pre">AbstractPreprocessing</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.OrbitsGenerator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">OrbitsGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(2.5,</span> <span class="pre">3.5,</span> <span class="pre">4.0,</span> <span class="pre">4.1,</span> <span class="pre">4.3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_orbits_per_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pts_per_orbit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homology_dimensions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_percentage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamical_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'classical_convention'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arbitrary_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.OrbitsGenerator" title="Permalink to this definition"></a></dt>
<dd><p>Generate Orbit dataset consistent of orbits defined by the dynamical system
x[n+1] = x[n] + r * y[n] * (1  - y[n]) % 1
y[n+1] = y[n] + r * x[n+1] * (1 - x[n+1]) % 1
Note that there is an x[n+1] value in the second dimension.
The parameter r is an hyperparameter and the classification task is to predict
it given the orbit.
By default r is chosen from (2.5, 3.5, 4.0, 4.1, 4.3).
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>parameters (Tuple[float]): </dt><dd><p>Hyperparameter of the dynamical systems.</p>
</dd>
<dt>num_orbits_per_class (int): </dt><dd><p>number of orbits per class.</p>
</dd>
<dt>num_pts_per_orbit (int): </dt><dd><p>number of points per orbit.</p>
</dd>
<dt>homology_dimensions (Sequence[int]): </dt><dd><p>homology dimension of the persistence
diagrams.</p>
</dd>
<dt>validation_percentage (float, optional): </dt><dd><p>Percentage of the validation dataset.
Defaults to 0.0.</p>
</dd>
<dt>test_percentage (float, optional): </dt><dd><p>Percentage of the test dataset. Defaults to 0.0.</p>
</dd>
<dt>dynamical_system (str, optional): </dt><dd><p>either use persistence paths
convention ´pp_convention´ or the classical convention
´classical_convention´. Defaults to ‘´classical_convention´’.</p>
</dd>
<dt>n_jobs (int, optional): </dt><dd><p>number of cpus to run the computation on. Defaults to 1.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.OrbitsGenerator.get_dataloader_combined">
<span class="sig-name descname"><span class="pre">get_dataloader_combined</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.datasets.DataLoaderKwargs" title="gdeep.data.datasets.parallel_orbit.DataLoaderKwargs"><span class="pre">DataLoaderKwargs</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.OrbitsGenerator.get_dataloader_combined" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Dataloader from the orbits dataset and the persistence diagrams
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>DataLoader: </dt><dd><p>Dataloader of orbits and persistence diagrams</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.OrbitsGenerator.get_dataloader_orbits">
<span class="sig-name descname"><span class="pre">get_dataloader_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.datasets.DataLoaderKwargs" title="gdeep.data.datasets.parallel_orbit.DataLoaderKwargs"><span class="pre">DataLoaderKwargs</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.OrbitsGenerator.get_dataloader_orbits" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Dataloader from the orbits dataset 
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>DataLoader: </dt><dd><p>Dataloader of orbits</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.OrbitsGenerator.get_dataloader_persistence_diagrams">
<span class="sig-name descname"><span class="pre">get_dataloader_persistence_diagrams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloaders_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.datasets.DataLoaderKwargs" title="gdeep.data.datasets.parallel_orbit.DataLoaderKwargs"><span class="pre">DataLoaderKwargs</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">DataLoader</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.OrbitsGenerator.get_dataloader_persistence_diagrams" title="Permalink to this definition"></a></dt>
<dd><p>Generates a Dataloader from the persistence diagrams dataset 
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>Tuple[DataLoader, DataLoader, DataLoader]:</dt><dd><p>Dataloaders of persistence diagrams</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.OrbitsGenerator.get_orbits">
<span class="sig-name descname"><span class="pre">get_orbits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.OrbitsGenerator.get_orbits" title="Permalink to this definition"></a></dt>
<dd><p>Returns the orbits as an ndarrays of shape
(num_classes * num_orbits_per_class, num_pts_per_orbit, 2)
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray: </dt><dd><p>Orbits</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.datasets.OrbitsGenerator.get_persistence_diagrams">
<span class="sig-name descname"><span class="pre">get_persistence_diagrams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.OrbitsGenerator.get_persistence_diagrams" title="Permalink to this definition"></a></dt>
<dd><p>Returns the orbits as an ndarrays of shape
(num_classes * num_orbits_per_class, num_topological_features, 3)
Returns:</p>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray: </dt><dd><p>Persistence diagrams</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.PersistenceDiagramFromFiles">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">PersistenceDiagramFromFiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.PersistenceDiagramFromFiles" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.Rotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">Rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis_0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.Rotation" title="Permalink to this definition"></a></dt>
<dd><p>Class for rotations</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.datasets.ToriDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">ToriDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.datasets.ToriDataset" title="Permalink to this definition"></a></dt>
<dd><p>This class is used to generate data loaders for the
family of tori-datasets</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>name:</dt><dd><p>name of the torus dataset to generate</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.datasets.create_pd_orbits">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">create_pd_orbits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homology_dimensions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#gdeep.data.datasets.create_pd_orbits" title="Permalink to this definition"></a></dt>
<dd><p>Computes the weak alpha persistence of the orbit data clouds.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>orbits (np.array): </dt><dd><p>Orbits of shape [n_points, 2]</p>
</dd>
<dt>homology_dimensions (tuple, optional): </dt><dd><p>Dimensions to compute the
persistence diagrams.
Defaults to (0, 1).</p>
</dd>
<dt>n_jobs (int, optional): </dt><dd><p>Number of cpus to use for parallel computation.
Defaults to multiprocessing.cpu_count().</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>np.array: </dt><dd><p>Array of persistence diagrams of shape
[num_classes, num_orbits, num_persistence_points, 3].
In the last dimension the first two values are the coordinates of
the points in the persistence diagrams and the third is the
homology dimension.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.datasets.generate_orbit_parallel">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_orbit_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_orbits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pts_per_orbit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[1.0]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#gdeep.data.datasets.generate_orbit_parallel" title="Permalink to this definition"></a></dt>
<dd><p>Generate sequence of points of a dynamical system
in a parallel manner.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>num_classes (int): </dt><dd><p>number of classes of dynamical systems.</p>
</dd>
<dt>num_orbits (int): </dt><dd><p>number of orbits of dynamical system per class.</p>
</dd>
<dt>num_pts_per_orbit (int, optional): </dt><dd><p>Number of points to generate.
Defaults to 100.</p>
</dd>
<dt>parameter (List[float], optional): </dt><dd><p>List of parameters of the dynamical
system.
Defaults to [1.0].</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>np.ndarray: </dt><dd><p>Array of sampled points of the dynamical system.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.datasets.get_dataset">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.datasets.</span></span><span class="sig-name descname"><span class="pre">get_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dataset</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.datasets.get_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Get a dataset from the factory</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>key :</dt><dd><p>The name of the dataset, correspondiong
to the key in the list of builders</p>
</dd>
<dt><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs:</dt><dd><p>The keyword arguments to pass to the dataset builder</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>torch.utils.data.Dataset:</dt><dd><p>The dataset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-gdeep.data.persistence_diagrams">
<span id="persistence-diagrams"></span><h2>Persistence Diagrams<a class="headerlink" href="#module-gdeep.data.persistence_diagrams" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gdeep.data.persistence_diagrams.</span></span><span class="sig-name descname"><span class="pre">OneHotEncodedPersistenceDiagram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homology_dimension_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="Permalink to this definition"></a></dt>
<dd><p>This class represents a single one-hot encoded persistence diagram.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>data:</dt><dd><p>The data of the persistence diagram.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.all_close">
<span class="sig-name descname"><span class="pre">all_close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.all_close" title="Permalink to this definition"></a></dt>
<dd><p>This method checks if the persistence diagrams are close.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.filter_by_lifetime">
<span class="sig-name descname"><span class="pre">filter_by_lifetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_lifetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lifetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.filter_by_lifetime" title="Permalink to this definition"></a></dt>
<dd><p>This method filters the persistence diagram by lifetime.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>min_lifetime:</dt><dd><p>The minimum lifetime of the remaining points.</p>
</dd>
<dt>max_lifetime:</dt><dd><p>The maximum lifetime of the remaining points.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.from_numpy">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.from_numpy" title="Permalink to this definition"></a></dt>
<dd><p>This method creates a persistence diagram from a numpy array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_all_points_in_homology_dimension">
<span class="sig-name descname"><span class="pre">get_all_points_in_homology_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">homology_dimension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_all_points_in_homology_dimension" title="Permalink to this definition"></a></dt>
<dd><p>This method returns all points in a given homology dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_lifetimes">
<span class="sig-name descname"><span class="pre">get_lifetimes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_lifetimes" title="Permalink to this definition"></a></dt>
<dd><p>This method returns the lifetimes of the points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_num_homology_dimensions">
<span class="sig-name descname"><span class="pre">get_num_homology_dimensions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_num_homology_dimensions" title="Permalink to this definition"></a></dt>
<dd><p>This method returns the number of homology dimensions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_num_points">
<span class="sig-name descname"><span class="pre">get_num_points</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_num_points" title="Permalink to this definition"></a></dt>
<dd><p>This method returns the number of points.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_points_in_homology_dimension">
<span class="sig-name descname"><span class="pre">get_points_in_homology_dimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">homology_dimension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_points_in_homology_dimension" title="Permalink to this definition"></a></dt>
<dd><p>This method returns all points in a given homology dimension.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_raw_data">
<span class="sig-name descname"><span class="pre">get_raw_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tensor</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.get_raw_data" title="Permalink to this definition"></a></dt>
<dd><p>This method returns the raw data of the persistence diagram.
This function should not be used to change the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.load">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.load" title="Permalink to this definition"></a></dt>
<dd><p>This method loads a persistence diagram from a file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Figure</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.plot" title="Permalink to this definition"></a></dt>
<dd><p>This method plots the persistence diagram.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>names: </dt><dd><p>The names of the homology dimensions.</p>
</dd>
</dl>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span> <span class="o">=</span>  <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span>                      <span class="p">([[</span><span class="mf">0.0928</span><span class="p">,</span> <span class="mf">0.0995</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0916</span><span class="p">,</span> <span class="mf">0.1025</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0978</span><span class="p">,</span> <span class="mf">0.1147</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0978</span><span class="p">,</span> <span class="mf">0.1147</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0916</span><span class="p">,</span> <span class="mf">0.1162</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0740</span><span class="p">,</span> <span class="mf">0.0995</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0728</span><span class="p">,</span> <span class="mf">0.0995</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0740</span><span class="p">,</span> <span class="mf">0.1162</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0728</span><span class="p">,</span> <span class="mf">0.1162</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0719</span><span class="p">,</span> <span class="mf">0.1343</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0830</span><span class="p">,</span> <span class="mf">0.2194</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0830</span><span class="p">,</span> <span class="mf">0.2194</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">],</span>
            <span class="p">[</span><span class="mf">0.0719</span><span class="p">,</span> <span class="mf">0.2194</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">1.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0000</span><span class="p">]])</span>

<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ord0&quot;</span><span class="p">,</span> <span class="s2">&quot;Ext0&quot;</span><span class="p">,</span> <span class="s2">&quot;Rel1&quot;</span><span class="p">,</span> <span class="s2">&quot;Ext1&quot;</span><span class="p">]</span>
<span class="n">pd</span> <span class="o">=</span> <span class="n">OneHotEncodedPersistenceDiagram</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.save" title="Permalink to this definition"></a></dt>
<dd><p>This method saves the persistence diagram to a file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.set_homology_dimension_names">
<span class="sig-name descname"><span class="pre">set_homology_dimension_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">homology_dimension_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram.set_homology_dimension_names" title="Permalink to this definition"></a></dt>
<dd><p>This method sets the homology dimension names.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.collate_fn_persistence_diagrams">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.persistence_diagrams.</span></span><span class="sig-name descname"><span class="pre">collate_fn_persistence_diagrams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.collate_fn_persistence_diagrams" title="Permalink to this definition"></a></dt>
<dd><p>This function collates the data for the persistence diagram by padding the data, converting
the data to tensors, converting the labels to tensors and generating masks for the valid
entries.</p>
<p>The input is a list of tuples of the form (persistence diagram, label).</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>batch:</dt><dd><p>The list of tuples of the form (persistence diagram, label).</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>The data, the labels and the masks.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.get_one_hot_encoded_persistence_diagram_from_gtda">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.persistence_diagrams.</span></span><span class="sig-name descname"><span class="pre">get_one_hot_encoded_persistence_diagram_from_gtda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">persistence_diagram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.get_one_hot_encoded_persistence_diagram_from_gtda" title="Permalink to this definition"></a></dt>
<dd><p>This function takes a single persistence diagram from giotto-tda and returns a one-hot encoded
persistence diagram.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>persistence_diagram: An array of shape (num_points, 3) where the first two columns</dt><dd><p>represent the coordinates of the points and the third column
represents the index of the homology dimension.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A one-hot encoded persistence diagram. If the persistence diagram has only one homology
dimension, the third column will be filled with ones.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gdeep.data.persistence_diagrams.get_one_hot_encoded_persistence_diagram_from_gudhi_extended">
<span class="sig-prename descclassname"><span class="pre">gdeep.data.persistence_diagrams.</span></span><span class="sig-name descname"><span class="pre">get_one_hot_encoded_persistence_diagram_from_gudhi_extended</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diagram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#gdeep.data.persistence_diagrams.OneHotEncodedPersistenceDiagram" title="gdeep.data.persistence_diagrams.one_hot_persistence_diagram.OneHotEncodedPersistenceDiagram"><span class="pre">OneHotEncodedPersistenceDiagram</span></a></span></span><a class="headerlink" href="#gdeep.data.persistence_diagrams.get_one_hot_encoded_persistence_diagram_from_gudhi_extended" title="Permalink to this definition"></a></dt>
<dd><p>Convert an extended persistence diagram of a single graph to an
array with one-hot encoded homology type.
Args:</p>
<blockquote>
<div><dl class="simple">
<dt>diagram (Tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]):</dt><dd><p>The diagram of an extended persistence of a single graph.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>np.ndarray:</dt><dd><p>The diagram in one-hot encoded homology type of size
(num_points, 6).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="analysis.html" class="btn btn-neutral float-left" title="Analysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="models.html" class="btn btn-neutral float-right" title="Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, L2F SA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>